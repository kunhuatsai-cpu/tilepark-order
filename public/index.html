<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Tile Park è¨‚è²¨ç³»çµ±</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel (ç”¨æ–¼åœ¨ç€è¦½å™¨ä¸­ç·¨è­¯ JSX) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700;900&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #f3f4f6; }
        
        /* å‹•ç•«å®šç¾© */
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade-in-up { animation: fadeInUp 0.6s ease-out forwards; }
        .animate-fade-in { animation: fadeIn 0.4s ease-out; }
        .animate-pop-in { animation: popIn 0.5s cubic-bezier(0.26, 0.53, 0.74, 1.48) forwards; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes popIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        /* è‡ªå®šç¾©æ²è»¸ */
        .custom-scrollbar::-webkit-scrollbar { width: 8px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #e2e8f0; border-radius: 20px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #cbd5e1; }
        
        /* æ—¥æœŸé¸æ“‡å™¨æ¨£å¼ä¿®æ­£ */
        input[type="date"]::-webkit-inner-spin-button,
        input[type="date"]::-webkit-calendar-picker-indicator {
          cursor: pointer;
          filter: invert(0.5);
        }
        
        /* Checkbox è‡ªå®šç¾©æ¨£å¼ */
        .checkbox-wrapper input:checked + div {
            background-color: #c25e00;
            border-color: #c25e00;
        }
        .checkbox-wrapper input:checked + div svg {
            display: block;
        }
    </style>
</head>
<body>

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useCallback } = React;

        // ğŸ›‘ æ‚¨çš„ Google Script ç¶²å€ (å·²æ›´æ–°ç‚ºæœ€æ–°ç‰ˆæœ¬)
        const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyKP7YGKdSFYYJMEI2tH7t3u3lILjfc3XGK-xlFx0o3se2_QnnvP-vNtEGcgZXt1Xx7/exec";

        // --- ğŸ› ï¸ å…§å»º SVG åœ–ç¤º ---
        const IconWrapper = ({ children, size = 20, className = "", ...props }) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className} {...props}>{children}</svg>
        );

        const Icons = {
          Bag: (p) => <IconWrapper {...p}><path d="M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z"/><path d="M3 6h18"/><path d="M16 10a4 4 0 0 1-8 0"/></IconWrapper>,
          Truck: (p) => <IconWrapper {...p}><path d="M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2"/><path d="M15 18H9"/><path d="M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14"/><circle cx="17" cy="18" r="2"/><circle cx="7" cy="18" r="2"/></IconWrapper>,
          User: (p) => <IconWrapper {...p}><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></IconWrapper>,
          Plus: (p) => <IconWrapper {...p}><path d="M5 12h14"/><path d="M12 5v14"/></IconWrapper>,
          Trash: (p) => <IconWrapper {...p}><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></IconWrapper>,
          Check: (p) => <IconWrapper {...p}><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></IconWrapper>,
          Pin: (p) => <IconWrapper {...p}><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></IconWrapper>,
          Phone: (p) => <IconWrapper {...p}><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></IconWrapper>,
          Next: (p) => <IconWrapper {...p}><path d="m9 18 6-6-6-6"/></IconWrapper>,
          Copy: (p) => <IconWrapper {...p}><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/></IconWrapper>,
          Archive: (p) => <IconWrapper {...p}><rect width="20" height="5" x="2" y="3" rx="1"/><path d="M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8"/><path d="M10 12h4"/></IconWrapper>,
          Alert: (p) => <IconWrapper {...p}><circle cx="12" cy="12" r="10"/><line x1="12" x2="12" y1="8" y2="12"/><line x1="12" x2="12.01" y1="16" y2="16"/></IconWrapper>,
          ChevronDown: (p) => <IconWrapper {...p}><path d="m6 9 6 6 6-6"/></IconWrapper>,
          Search: (p) => <IconWrapper {...p}><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></IconWrapper>,
          Save: (p) => <IconWrapper {...p}><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></IconWrapper>,
          Refresh: (p) => <IconWrapper {...p}><path d="M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/><path d="M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16"/><path d="M16 21h5v-5"/></IconWrapper>,
          Line: (p) => <IconWrapper {...p}><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"/></IconWrapper>
        };

        // --- Components ---

        const Logo = ({ isMobileHeader = false }) => (
          <div className={`flex flex-col items-center justify-center ${isMobileHeader ? 'p-2' : 'md:p-4'}`}>
            <img 
              src="https://lh3.googleusercontent.com/d/1N9nrujoaGkFpdGhsBRgOs_WE-RgQEhU2" 
              alt="TILE PARK" 
              className={`${isMobileHeader ? 'w-40' : 'w-48 md:w-60 lg:w-64'} object-contain transition-all hover:scale-105`}
              style={{ height: 'auto' }} 
            />
          </div>
        );

        const Modal = ({ message, onClose, type = 'success' }) => (
          <div className="fixed inset-0 bg-black/80 flex items-center justify-center z-[9999] p-6 backdrop-blur-md animate-fade-in font-sans">
            <div className="bg-white w-full max-w-xs rounded-3xl shadow-2xl overflow-hidden transform transition-all animate-pop-in">
              <div className={`p-8 text-center ${type === 'success' ? 'bg-green-50' : 'bg-orange-50'}`}>
                <div className={`mx-auto w-14 h-14 rounded-full flex items-center justify-center mb-4 ${type === 'success' ? 'bg-green-100 text-green-600' : 'bg-orange-100 text-[#c25e00]'}`}>
                  {type === 'success' ? <Icons.Check size={28} /> : <Icons.Alert size={28} />}
                </div>
                <div className="text-gray-800 font-bold text-lg mb-2 whitespace-pre-wrap leading-relaxed">{message}</div>
              </div>
              <button onClick={onClose} className="w-full py-5 bg-[#222] text-white font-bold tracking-widest active:bg-black transition-colors">ç¢ºå®š</button>
            </div>
          </div>
        );

        const ConfirmModal = ({ onClose, onConfirm, isReservation }) => (
          <div className="fixed inset-0 bg-black/80 flex items-center justify-center z-[9999] p-6 backdrop-blur-md animate-fade-in font-sans">
            <div className="bg-white w-full max-w-sm rounded-3xl shadow-2xl overflow-hidden transform transition-all animate-pop-in border border-gray-100">
              <div className="p-8 text-center bg-white">
                <div className={`mx-auto w-16 h-16 rounded-full flex items-center justify-center mb-5 ring-4 ${isReservation ? 'bg-blue-50 text-blue-600 ring-blue-50/50' : 'bg-orange-50 text-[#c25e00] ring-orange-50/50'}`}>
                   {isReservation ? <Icons.Archive size={32} /> : <Icons.Alert size={32} />}
                </div>
                <h3 className="text-xl font-black text-gray-900 mb-2 tracking-wider">{isReservation ? 'ä¿ç•™å–®ç¢ºèª' : 'è¨‚å–®ç¢ºèª'}</h3>
                <p className="text-gray-500 text-sm font-medium mb-6">è«‹ç¢ºèªæ‚¨çš„å…§å®¹æ˜¯å¦æ­£ç¢º</p>
                
                {isReservation ? (
                    <div className="p-5 bg-blue-50 rounded-2xl border border-blue-100 text-left space-y-4">
                       <div className="flex items-start gap-3">
                          <div className="mt-0.5 text-blue-500 shrink-0"><Icons.Alert size={16} /></div>
                          <div className="text-sm text-blue-800">
                            <p className="font-bold mb-1 text-blue-900">éœ€æ±‚è¨»è¨˜ â‰  æ­£å¼ä¿ç•™</p>
                            <p className="text-blue-700/80 text-xs leading-relaxed text-justify">åƒ…ç‚ºç³»çµ±è¨»è¨˜éœ€æ±‚ï¼Œå¯¦éš›å‡ºè²¨ä»ä»¥ã€Œç¢ºèªè¨‚å–®ï¼‹ç•¶æ™‚åº«å­˜ã€ç‚ºæº–ã€‚</p>
                          </div>
                       </div>
                       <div className="flex items-start gap-3">
                          <div className="mt-0.5 text-blue-500 shrink-0"><Icons.Alert size={16} /></div>
                          <div className="text-sm text-blue-800">
                            <p className="font-bold mb-1 text-blue-900">ä¿ç•™æœŸé™ä¸€å€‹æœˆ</p>
                            <p className="text-blue-700/80 text-xs leading-relaxed text-justify">è‹¥æœ‰å…¶ä»–å®¢æˆ¶ä¸‹å–®ï¼Œåº«å­˜å°‡å„ªå…ˆé…çµ¦å·²ç¢ºèªè¨‚å–®çš„å®¢æˆ¶ã€‚</p>
                          </div>
                       </div>
                    </div>
                ) : (
                    <div className="p-5 bg-red-50 rounded-2xl border border-red-100 text-left">
                       <div className="flex items-start gap-3">
                          <div className="mt-1 text-red-500"><Icons.Alert size={18} /></div>
                          <div>
                            <p className="text-red-800 font-black text-base tracking-widest mb-1">
                              ç‰¹åˆ¥è²æ˜
                            </p>
                            <p className="text-red-600 text-sm font-bold leading-relaxed">
                              æœ¬å…¬å¸æ‰€æœ‰ç”¢å“<br/>ç¶“å‡ºè²¨çš†ä¸é€€æ›è²¨
                            </p>
                          </div>
                       </div>
                    </div>
                )}
              </div>
              <div className="flex border-t border-gray-100">
                <button onClick={onClose} className="flex-1 py-5 bg-gray-50 text-gray-500 font-bold tracking-widest hover:bg-gray-100 transition-colors">è¿”å›ä¿®æ”¹</button>
                <button onClick={onConfirm} className={`flex-1 py-5 text-white font-bold tracking-widest transition-colors ${isReservation ? 'bg-blue-600 hover:bg-blue-500' : 'bg-[#222] hover:bg-[#c25e00]'}`}>ç¢ºèªé€å‡º</button>
              </div>
            </div>
          </div>
        );

        const SectionHeader = ({ icon: Icon, title, rightContent }) => (
          <div className="flex items-center justify-between mb-5 mt-2 px-1">
            <div className="flex items-center gap-2">
                <div className="p-2.5 bg-orange-100 rounded-xl text-[#c25e00]">
                <Icon size={20} />
                </div>
                <h3 className="font-black text-gray-800 text-base md:text-lg tracking-widest">{title}</h3>
            </div>
            {rightContent}
          </div>
        );

        // --- ğŸŒŸ ä¿®æ­£ç‰ˆï¼šç”¢å“æœå°‹å»ºè­°çµ„ä»¶ (æ”¯æ´æ‰‹æ©Ÿè§¸æ§) ---
        const ProductAutocomplete = ({ value, onChange, onSelect, productList, isLoading }) => {
          const [suggestions, setSuggestions] = useState([]);
          const [showSuggestions, setShowSuggestions] = useState(false);
          const wrapperRef = useRef(null);

          useEffect(() => {
            function handleClickOutside(event) {
              if (wrapperRef.current && !wrapperRef.current.contains(event.target)) {
                setShowSuggestions(false);
              }
            }
            // ğŸ“± å¢åŠ  touchstart ç›£è½ï¼Œè§£æ±ºæ‰‹æ©Ÿé»æ“Šå¤–éƒ¨ä¸é—œé–‰é¸å–®çš„å•é¡Œ
            document.addEventListener("mousedown", handleClickOutside);
            document.addEventListener("touchstart", handleClickOutside);
            return () => {
                document.removeEventListener("mousedown", handleClickOutside);
                document.removeEventListener("touchstart", handleClickOutside);
            };
          }, []);

          // ğŸŒŸ è‡ªå‹•æ›´æ–°å»ºè­°åˆ—è¡¨ï¼šç•¶ productList æ›´æ–°ä¸”æœ‰è¼¸å…¥å€¼æ™‚ï¼Œé‡æ–°ç¯©é¸
          useEffect(() => {
             if (value && productList.length > 0) {
                const filtered = productList.filter(p => 
                  (String(p.id).toLowerCase().includes(value.toLowerCase())) || 
                  (String(p.name).toLowerCase().includes(value.toLowerCase()))
                ).slice(0, 10);
                
                // åªæœ‰ç•¶æ–°åˆ—è¡¨è·ŸèˆŠåˆ—è¡¨ä¸åŒï¼Œæˆ–æ˜¯åˆ—è¡¨åŸæœ¬æ˜¯ç©ºçš„ï¼Œæ‰æ›´æ–°
                setSuggestions(filtered);
                // å¦‚æœæœ‰æ‰¾åˆ°çµæœï¼Œä¸”ä½¿ç”¨è€…æ­£åœ¨è¼¸å…¥ï¼Œç¢ºä¿é¸å–®æ˜¯æ‰“é–‹çš„
                if(filtered.length > 0) setShowSuggestions(true);
             }
          }, [productList, value]); 

          const handleInputChange = (e) => {
            const inputVal = e.target.value;
            onChange(inputVal);

            // é€™è£¡çš„é‚è¼¯æœƒè¢«ä¸Šé¢çš„ useEffect æ¥æ‰‹è™•ç†
            if (!inputVal) {
              setShowSuggestions(false);
            }
          };

          const handleSelect = (product) => {
            onSelect(product);
            setShowSuggestions(false);
          };

          return (
            <div ref={wrapperRef} className="relative w-full">
              <div className="relative">
                <input 
                  required 
                  className={`w-full bg-gray-50 border-none rounded-xl px-5 py-4 pl-12 text-lg md:text-xl font-bold focus:ring-2 focus:ring-[#c25e00]/20 outline-none transition-all placeholder:text-gray-300 font-sans ${isLoading ? 'opacity-70 cursor-wait' : ''}`}
                  placeholder={isLoading ? "ğŸ” æ­£åœ¨é€£ç·šç”¢å“è³‡æ–™åº«..." : "è¼¸å…¥è²¨è™Ÿæˆ–å“åæœå°‹"} 
                  value={value} 
                  onChange={handleInputChange} 
                  onFocus={() => value && suggestions.length > 0 && setShowSuggestions(true)}
                  disabled={isLoading}
                />
                <div className={`absolute left-4 top-1/2 -translate-y-1/2 pointer-events-none ${isLoading ? 'animate-spin text-[#c25e00]' : 'text-gray-300'}`}>
                    {isLoading ? <Icons.Search size={20} /> : <Icons.Search size={20} />}
                </div>
              </div>
              
              {showSuggestions && suggestions.length > 0 && (
                <ul className="absolute z-50 w-full bg-white border border-gray-100 rounded-xl mt-2 shadow-2xl max-h-60 overflow-y-auto custom-scrollbar animate-fade-in">
                  {suggestions.map((p, idx) => (
                    <li 
                      key={idx} 
                      onClick={() => handleSelect(p)}
                      // ğŸ“± å¢åŠ  onTouchEnd ç¢ºä¿æ‰‹æ©Ÿè§¸æ§èƒ½æ­£ç¢ºè§¸ç™¼é¸å–
                      onTouchEnd={(e) => { e.preventDefault(); handleSelect(p); }}
                      className="px-5 py-3 hover:bg-orange-50 cursor-pointer transition-colors border-b border-gray-50 last:border-none group"
                    >
                      <div className="flex justify-between items-center">
                        <div>
                            <span className="font-bold text-[#c25e00] mr-2">{p.id}</span>
                            <span className="text-gray-700 font-medium">{p.name}</span>
                        </div>
                        {p.packing && <span className="text-xs text-gray-400 bg-gray-100 px-2 py-1 rounded-full group-hover:bg-orange-100 group-hover:text-orange-600 transition-colors">{p.packing}ç‰‡/ç®±</span>}
                      </div>
                    </li>
                  ))}
                </ul>
              )}
            </div>
          );
        };

        function App() {
          const [styleLoaded, setStyleLoaded] = useState(false);
          const [productList, setProductList] = useState([]);
          const [isProductLoading, setIsProductLoading] = useState(true);
          const [modalData, setModalData] = useState(null);

          const [rememberMe, setRememberMe] = useState(true); 

          // ğŸŸ¢ é è¨­å–®ä½æ”¹ç‚º 'å¼µ'
          const [items, setItems] = useState([{ id: 1, name: '', qty: '', unit: 'å¼µ', note: '' }]); 
          const [loading, setLoading] = useState(false);
          const [submitted, setSubmitted] = useState(false);
          const [orderId, setOrderId] = useState('');
          const [showConfirm, setShowConfirm] = useState(false);
          const [isReservation, setIsReservation] = useState(false);
          
          const today = new Date().toISOString().split('T')[0];

          const [formData, setFormData] = useState({
            orderType: 'æ–°æ¡ˆå ´',
            deliveryDate: today, 
            deliveryTime: 'ä¸Šåˆ (09-12)',
            deliveryContact: '', 
            deliveryPhone: '', 
            deliveryAddress: '',
            orderCompany: '', 
            orderContact: '', 
            orderPhone: '',
          });

          // ğŸ“¦ å°è£è®€å–ç”¢å“çš„å‡½å¼ï¼Œæ–¹ä¾¿æ‰‹å‹•å‘¼å«
          const fetchProducts = useCallback((showToast = false) => {
            setIsProductLoading(true);
            // ğŸŒŸ åŠ ä¸Šæ™‚é–“æˆ³è¨˜ _t é˜²æ­¢ç€è¦½å™¨å¿«å–ï¼Œç¢ºä¿æŠ“åˆ°æœ€æ–°è³‡æ–™
            // ä¸¦åŠ ä¸Š { cache: 'no-store' } ç¢ºä¿ç€è¦½å™¨ä¸ç·©å­˜
            fetch(`${GOOGLE_SCRIPT_URL}?action=getProducts&_t=${new Date().getTime()}`, { cache: "no-store" })
              .then(res => res.json())
              .then(data => {
                if(Array.isArray(data)){
                    if(data.length === 0) setModalData({ msg: "âš ï¸ é€£ç·šæˆåŠŸä½†æ‰¾ä¸åˆ°ç”¢å“è³‡æ–™ã€‚", type: 'error' });
                    setProductList(data);
                    if(showToast) {
                        // ç°¡å–®æç¤º
                        alert("âœ… ç”¢å“è³‡æ–™å·²æ›´æ–°ï¼");
                    }
                }
                setIsProductLoading(false);
              })
              .catch(err => {
                console.error("Error:", err);
                setIsProductLoading(false);
                if(showToast) alert("âŒ æ›´æ–°å¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²è·¯");
              });
          }, []);

          // ğŸŒŸ 1. è¼‰å…¥æ™‚ï¼šè®€å– localStorage è³‡æ–™ & ç”¢å“è³‡æ–™
          // ğŸŸ¢ ä¿®æ”¹ï¼šåªè®€å–å®¢æˆ¶è³‡æ–™ï¼Œä¸è®€å–å‡ºè²¨è³‡æ–™
          useEffect(() => {
            if (window.tailwind) setStyleLoaded(true);
            else setTimeout(() => setStyleLoaded(true), 500);

            // è¼‰å…¥ç”¢å“ (åˆæ¬¡)
            fetchProducts(false);

            // è®€å–ä½¿ç”¨è€…å„²å­˜çš„è³‡æ–™
            try {
                const savedData = localStorage.getItem('tilePark_userData');
                if (savedData) {
                    const parsed = JSON.parse(savedData);
                    setFormData(prev => ({
                        ...prev,
                        orderCompany: parsed.orderCompany || '',
                        orderContact: parsed.orderContact || '',
                        orderPhone: parsed.orderPhone || '',
                        // ğŸŸ¢ ç¢ºä¿é€™äº›æ¬„ä½ä¸æœƒè¢«å¿«å–è¦†è“‹
                        // deliveryAddress: parsed.deliveryAddress || '', 
                        // deliveryContact: parsed.deliveryContact || '', 
                        // deliveryPhone: parsed.deliveryPhone || '' 
                    }));
                }
            } catch (e) { console.error("Cache load error", e); }

          }, [fetchProducts]);

          // ğŸŸ¢ æ–°å¢å“é …æ™‚ï¼Œé è¨­å–®ä½ç‚º 'å¼µ'
          const addItem = () => {
            setItems([...items, { id: Date.now(), name: '', qty: '', unit: 'å¼µ', note: '' }]);
            setTimeout(() => window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' }), 100);
          };

          const removeItem = (id) => items.length > 1 && setItems(items.filter(item => item.id !== id));
          
          const updateItem = (id, field, value) => {
            setItems(items.map(item => item.id === id ? { ...item, [field]: value } : item));
          };

          const handleProductSelect = (id, product) => {
            const displayName = product.name; // ğŸŒŸ åªé¡¯ç¤ºç”¢å“åç¨±
            
            setItems(items.map(item => {
              if (item.id === id) {
                return { 
                  ...item, 
                  name: displayName,
                  // ğŸŸ¢ è‹¥ç”¢å“ç„¡é è¨­å–®ä½ï¼Œå‰‡é è¨­ç‚º 'å¼µ'
                  unit: product.unit || 'å¼µ',
                };
              }
              return item;
            }));
          };

          const handleSubmit = (e) => {
            e.preventDefault();
            setShowConfirm(true);
          };

          const handleFinalSubmit = async () => {
            setShowConfirm(false);
            setLoading(true);
            
            // ğŸŒŸ 2. é€å‡ºæ™‚ï¼šå„²å­˜è³‡æ–™åˆ° localStorage
            // ğŸŸ¢ ä¿®æ”¹ï¼šåªå„²å­˜å®¢æˆ¶è³‡æ–™ï¼Œä¸å„²å­˜å‡ºè²¨è³‡æ–™
            if (rememberMe) {
                const dataToSave = {
                    orderCompany: formData.orderCompany,
                    orderContact: formData.orderContact,
                    orderPhone: formData.orderPhone,
                    // deliveryAddress: formData.deliveryAddress, // âŒ ä¸å­˜
                    // deliveryContact: formData.deliveryContact, // âŒ ä¸å­˜
                    // deliveryPhone: formData.deliveryPhone // âŒ ä¸å­˜
                };
                localStorage.setItem('tilePark_userData', JSON.stringify(dataToSave));
            }

            const newOrderId = `TILE-${new Date().toISOString().slice(5,10).replace('-','')}${Math.floor(1000 + Math.random() * 9000)}`;
            const finalOrderType = isReservation ? `${formData.orderType} (ä¿ç•™åº«å­˜)` : formData.orderType;

            // ğŸŒŸ é—œéµä¿®æ­£ï¼šä¸å†å°‡ unit åˆä½µåˆ° qty è£¡
            const itemsForBackend = items.map(item => ({
                ...item,
                qty: item.qty, // ä¿æŒç´”æ•¸å­—
                unit: item.unit || 'å¼µ' // ç¢ºä¿æœ‰å–®ä½ï¼Œé è¨­ç‚ºå¼µ
            }));

            const submitData = { 
                action: 'create', // ğŸŸ¢ æ–°å¢ï¼šå‘Šè¨´å¾Œç«¯é€™æ˜¯å»ºç«‹è¨‚å–®
                orderId: newOrderId, 
                items: itemsForBackend, 
                ...formData, 
                orderType: finalOrderType, 
                timestamp: new Date().toLocaleString() 
            };

            try {
              // ğŸŒŸ é—œéµä¿®æ­£ï¼šæ”¹ç”¨ form-urlencoded æ–¹å¼å‚³é€ï¼Œå°æ‡‰ GAS çš„ e.parameter.payload
              // é€™é€šå¸¸æ¯” raw postData æ›´ç©©å®šï¼Œä¸”ä¸€å®šæœƒå‘½ä¸­å¾Œç«¯çš„ç¬¬ä¸€å€‹åˆ¤æ–·å¼
              const formDataEncoded = new URLSearchParams();
              formDataEncoded.append('payload', JSON.stringify(submitData));

              await fetch(GOOGLE_SCRIPT_URL, {
                method: 'POST',
                mode: 'no-cors',
                headers: { 
                  'Content-Type': 'application/x-www-form-urlencoded' 
                },
                body: formDataEncoded.toString()
              });
              
              setOrderId(newOrderId);
              setSubmitted(true);
              window.scrollTo(0, 0);
            } catch (error) {
              setModalData({ msg: "ç³»çµ±å¿™ç¢Œä¸­ï¼Œè«‹ç¨å¾Œå†è©¦æˆ–è¯ç¹«å®¢æœã€‚", type: 'error' });
            } finally {
              setLoading(false);
            }
          };

          const copyOrder = () => {
            // ğŸŸ¢ è¤‡è£½æ–‡å­—é è¨­ä¹Ÿæ”¹ç‚º 'å¼µ' (å¦‚æœ unit æ˜¯ç©ºçš„)
            const itemsList = items.map((it, idx) => `${idx + 1}. ${it.name} x ${it.qty}${it.unit || 'å¼µ'} (${it.note || 'ç„¡å‚™è¨»'})`).join('\n');
            const title = isReservation ? 'ã€Tile Park ä¿ç•™å–®é€šçŸ¥ã€‘' : 'ã€Tile Park è¨‚å–®é€šçŸ¥ã€‘';
            const typeLabel = isReservation ? 'éœ€æ±‚æ€§è³ªï¼šä¿ç•™åº«å­˜' : 'éœ€æ±‚æ€§è³ªï¼šæ­£å¼å‡ºè²¨';
            // ğŸŸ¢ ä¿®æ­£ï¼šé€è²¨æ—¥æœŸ -> å‡ºè²¨æ—¥æœŸ
            const dateLabel = isReservation ? 'é è¨ˆå‡ºè²¨' : 'å‡ºè²¨æ—¥æœŸ';
            const dateInfo = `${dateLabel}ï¼š${formData.deliveryDate}`;

            const text = `${title}\nå–®è™Ÿï¼š${orderId}\né¡å‹ï¼š${formData.orderType}\n${typeLabel}\nå…¬å¸ï¼š${formData.orderCompany}\n\nè¨‚è³¼å…§å®¹ï¼š\n${itemsList}\n\n${dateInfo}\næ™‚æ®µï¼š${formData.deliveryTime}\nåœ°å€ï¼š${formData.deliveryAddress}\n\nè«‹å”åŠ©ç¢ºèªï¼Œè¬è¬ï¼`;
            
            const fallbackCopy = (content) => {
                const ta = document.createElement("textarea"); 
                ta.value = content; 
                document.body.appendChild(ta); 
                ta.select();
                try { 
                  document.execCommand('copy'); 
                  setModalData({ msg: isReservation ? "âœ… ä¿ç•™å–®å·²è¤‡è£½ï¼" : "âœ… è¨‚å–®å·²è¤‡è£½ï¼", type: 'success' }); 
                } catch (err) { 
                  setModalData({ msg: "âŒ è¤‡è£½å¤±æ•—ï¼Œè«‹æ‰‹å‹•æˆªåœ–", type: 'error' }); 
                }
                document.body.removeChild(ta);
            };

            if (navigator.clipboard && navigator.clipboard.writeText) { 
              navigator.clipboard.writeText(text)
                .then(() => setModalData({ msg: isReservation ? "âœ… ä¿ç•™å–®å·²è¤‡è£½ï¼" : "âœ… è¨‚å–®å·²è¤‡è£½ï¼", type: 'success' }))
                .catch(() => fallbackCopy(text)); 
            } else { 
              fallbackCopy(text); 
            }
          };

          if (!styleLoaded) {
            return (
              <div className="fixed inset-0 bg-white flex flex-col items-center justify-center font-sans">
                <div className="w-12 h-12 border-4 border-gray-100 border-t-[#c25e00] rounded-full animate-spin mb-4"></div>
                <div className="text-[10px] text-gray-400 tracking-[0.3em] font-bold">TILE PARK SYSTEM</div>
              </div>
            );
          }

          if (submitted) {
            return (
              <div className="min-h-screen bg-gray-100 flex flex-col items-center justify-center p-6 animate-fade-in font-sans">
                {modalData && <Modal message={modalData.msg} type={modalData.type} onClose={() => setModalData(null)} />}
                
                <div className="bg-white w-full max-w-sm shadow-2xl rounded-3xl overflow-hidden mb-8 relative border border-gray-100">
                  <div className={`h-2.5 w-full ${isReservation ? 'bg-blue-600' : 'bg-[#c25e00]'}`}></div>
                  <div className="p-10 text-center">
                    <div className={`w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-6 shadow-sm ring-8 ${isReservation ? 'bg-blue-50 text-blue-600 ring-blue-50' : 'bg-green-50 text-green-500 ring-green-50'}`}>
                      {isReservation ? <Icons.Archive size={40} /> : <Icons.Check size={40} />}
                    </div>
                    <h2 className="text-2xl font-black text-gray-900 mb-2">
                        {isReservation ? 'ä¿ç•™å–®å·²é€å‡º' : 'è¨‚å–®å·²æˆåŠŸé€å‡º'}
                    </h2>
                    <p className={`font-mono text-base font-bold mb-8 tracking-widest uppercase ${isReservation ? 'text-blue-600' : 'text-[#c25e00]'}`}>ID: {orderId}</p>

                    <div className="bg-gray-50 rounded-2xl p-6 text-left space-y-4 border border-gray-100">
                       <div className="flex justify-between text-sm md:text-base"><span className="text-gray-400">è¨‚è³¼å…¬å¸</span><span className="font-bold">{formData.orderCompany}</span></div>
                       <div className="flex justify-between text-sm md:text-base"><span className="text-gray-400">é¡å‹</span><span className="font-bold">{isReservation ? 'ä¿ç•™åº«å­˜' : 'æ­£å¼å‡ºè²¨'}</span></div>
                       {/* ğŸŸ¢ ä¿®æ­£ï¼šé€è²¨æ—¥æœŸ -> å‡ºè²¨æ—¥æœŸ */}
                       <div className="flex justify-between text-sm md:text-base"><span className="text-gray-400">{isReservation ? 'é è¨ˆå‡ºè²¨' : 'å‡ºè²¨æ—¥æœŸ'}</span><span className="font-bold">{formData.deliveryDate}</span></div>
                    </div>
                    
                    {isReservation && (
                        <div className="mt-6 p-4 bg-blue-50/50 rounded-xl border border-blue-100/50 text-xs text-blue-400 leading-relaxed text-justify">
                            *è²¼å¿ƒæé†’ï¼šä¿ç•™æœŸé™åŸå‰‡ä¸Šç‚ºä¸€å€‹æœˆï¼Œè‹¥æœ‰å…¶ä»–æ­£å¼è¨‚å–®ï¼Œåº«å­˜å°‡å„ªå…ˆåˆ†é…ã€‚
                        </div>
                    )}
                  </div>
                </div>
                
                <div className="w-full max-w-sm space-y-4 px-4 md:px-0">
                   <button onClick={copyOrder} className="w-full bg-[#222] text-white py-5 rounded-2xl font-black tracking-widest shadow-xl flex items-center justify-center gap-3 active:scale-95 transition-all text-lg group">
                     <Icons.Copy size={22} className="group-hover:scale-110 transition-transform" /> 
                     {isReservation ? 'è¤‡è£½ä¿ç•™å–®å…§å®¹' : 'è¤‡è£½è¨‚å–®å…§å®¹'}
                   </button>
                   
                   <a href="https://line.me/ti/p/@tileparktw" target="_blank" rel="noreferrer" className="w-full bg-[#06C755] text-white py-5 rounded-2xl font-black tracking-widest shadow-xl flex items-center justify-center gap-2 active:scale-95 transition-all text-lg">
                     å‰å¾€ LINE ç¢ºèªåº«å­˜
                   </a>
                   <button onClick={() => window.location.reload()} className="w-full py-4 text-sm text-gray-400 font-bold tracking-widest uppercase hover:text-gray-600 transition-colors font-sans">è¿”å›é¦–é </button>
                </div>
              </div>
            );
          }

          return (
            <div className="min-h-screen bg-gray-100 font-sans text-gray-800 selection:bg-[#c25e00] selection:text-white overflow-x-hidden">
              {modalData && <Modal message={modalData.msg} type={modalData.type} onClose={() => setModalData(null)} />}
              
              {showConfirm && <ConfirmModal onClose={() => setShowConfirm(false)} onConfirm={handleFinalSubmit} isReservation={isReservation} />}

              <div className="w-full max-w-7xl mx-auto md:flex md:shadow-2xl md:min-h-screen bg-white md:overflow-hidden relative font-sans">
                
                {/* --- å·¦å´å“ç‰Œå€ --- */}
                <aside className="w-full md:w-[32%] lg:w-[28%] bg-white border-b md:border-b-0 md:border-r border-gray-100 flex flex-col items-center justify-start md:justify-between p-4 md:p-12 pt-6 md:pt-20 lg:pt-24 md:pb-20 relative shrink-0">
                    
                    <div className="flex flex-col items-center w-full">
                      <Logo isMobileHeader={false} />
                    </div>
                    
                    <div className="hidden md:flex flex-col items-center text-center w-full px-2">
                      <div className="w-16 h-1.5 bg-[#c25e00] mb-8 rounded-full"></div>
                      <h2 className="text-xl md:text-2xl font-black tracking-[0.05em] lg:tracking-[0.1em] text-gray-900 leading-tight whitespace-nowrap mb-6">è–©é‰…åœ‹éš›æœ‰é™å…¬å¸</h2>
                      
                      <div className="text-xs md:text-sm text-gray-400 leading-relaxed space-y-4 font-medium">
                         <p className="flex items-center justify-center gap-2 hover:text-gray-600 transition-colors cursor-default whitespace-nowrap">
                            <Icons.Pin size={14} className="shrink-0 text-[#c25e00]"/> æ–°åŒ—å¸‚æ¿æ©‹å€é‡‘é–€è¡—215å··78-5è™Ÿ
                         </p>
                         <p className="flex items-center justify-center gap-2 hover:text-[#c25e00] transition-colors font-bold text-gray-600">
                            <Icons.Phone size={14} className="shrink-0"/> 02-86860028
                         </p>
                         {/* ğŸŸ¢ æ–°å¢ï¼šé›»è…¦ç‰ˆå´é‚Šæ¬„ LINE é€£çµ */}
                         <a href="https://line.me/R/ti/p/@tileparktw" target="_blank" rel="noreferrer" className="flex items-center justify-center gap-2 hover:text-[#06C755] transition-colors font-bold text-gray-600">
                            <Icons.Line size={14} className="shrink-0"/> LINE: @tileparktw
                         </a>
                      </div>
                      <div className="pt-8 text-[10px] text-gray-300 font-serif tracking-[0.4em] uppercase">Authentic Japanese Tiles</div>
                    </div>
                </aside>

                {/* --- å³å´ï¼šä¸»å…§å®¹å€ --- */}
                <main className="flex-1 bg-gray-50 md:overflow-y-auto custom-scrollbar relative">
                  <form onSubmit={handleSubmit} className="p-4 md:p-10 lg:p-16 max-w-4xl mx-auto pb-32 md:pb-24">
                    
                    {/* é ‚éƒ¨åˆ‡æ›å€ï¼šæ¡ˆå ´é¡å‹ & è¨‚å–®æ€§è³ª */}
                    <div className="grid grid-cols-1 gap-4 mb-12">
                        {/* ç¬¬ä¸€å±¤ï¼šæ¡ˆå ´é¡å‹ */}
                        <div className="bg-gray-200/50 p-1.5 rounded-2xl flex shadow-inner">
                        {['æ–°æ¡ˆå ´', 'æ¡ˆå ´è¿½åŠ è¨‚å–®'].map((type) => (
                            <button
                            key={type}
                            type="button"
                            onClick={() => setFormData({...formData, orderType: type})}
                            className={`flex-1 py-3 text-sm md:text-lg font-black rounded-xl transition-all duration-300 ${
                                formData.orderType === type 
                                ? 'bg-white text-[#c25e00] shadow-md scale-100' 
                                : 'text-gray-400 hover:text-gray-600 scale-95 opacity-70'
                            }`}
                            >
                            {type}
                            </button>
                        ))}
                        </div>

                        {/* ç¬¬äºŒå±¤ï¼šæ­£å¼å‡ºè²¨ vs ä¿ç•™åº«å­˜ */}
                        <div className={`p-1.5 rounded-2xl flex shadow-inner transition-colors duration-300 ${isReservation ? 'bg-blue-100/50' : 'bg-green-100/50'}`}>
                            <button
                                type="button"
                                onClick={() => setIsReservation(false)}
                                className={`flex-1 py-3 text-sm md:text-lg font-black rounded-xl transition-all duration-300 flex items-center justify-center gap-2 ${
                                    !isReservation 
                                    ? 'bg-white text-[#c25e00] shadow-md scale-100' 
                                    : 'text-gray-400 hover:text-gray-600 scale-95 opacity-70'
                                }`}
                            >
                                 <Icons.Truck size={18} /> æ­£å¼å‡ºè²¨
                            </button>
                            <button
                                type="button"
                                onClick={() => setIsReservation(true)}
                                className={`flex-1 py-3 text-sm md:text-lg font-black rounded-xl transition-all duration-300 flex items-center justify-center gap-2 ${
                                    isReservation 
                                    ? 'bg-white text-blue-600 shadow-md scale-100' 
                                    : 'text-gray-400 hover:text-gray-600 scale-95 opacity-70'
                                }`}
                            >
                                <Icons.Archive size={18} /> åƒ…ä¿ç•™åº«å­˜
                            </button>
                        </div>
                    </div>

                    <div className="space-y-16">
                      
                      {/* 1. è¨‚è³¼å®¢æˆ¶è³‡æ–™ (å·²ç§»åˆ°æœ€ä¸Šæ–¹) */}
                      <section className="animate-fade-in-up" style={{ animationDelay: '0.1s' }}>
                        <SectionHeader icon={Icons.User} title="è¨‚è³¼å®¢æˆ¶è³‡æ–™" />
                        <div className="bg-white p-8 rounded-[2.5rem] shadow-sm border border-gray-100 space-y-8">
                          <div className="space-y-2">
                            <label className="text-xs md:text-sm text-gray-400 font-black uppercase mb-1 block">å…¬å¸å¯¶è™Ÿ (æŠ¬é ­)</label>
                            <input required placeholder="è«‹è¼¸å…¥å®Œæ•´å…¬å¸åç¨±" className="w-full bg-gray-50 border-none rounded-xl p-5 text-lg md:text-xl font-bold focus:ring-2 focus:ring-[#c25e00]/20 font-sans"
                              value={formData.orderCompany} onChange={e => setFormData({...formData, orderCompany: e.target.value})} />
                          </div>
                          <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                              <div className="space-y-2">
                                <label className="text-xs md:text-sm text-gray-500 font-black mb-1 block">è¨‚è³¼ç¶“è¾¦äºº</label>
                                {/* ğŸŸ¢ ä¿®æ­£ï¼šç§»é™¤ required */}
                                <input placeholder="ç¶“è¾¦å§“å" className="w-full bg-gray-50 border-none rounded-xl p-4 text-base md:text-lg font-bold font-sans"
                                value={formData.orderContact} onChange={e => setFormData({...formData, orderContact: e.target.value})} />
                              </div>
                              <div className="space-y-2">
                                <label className="text-xs md:text-sm text-gray-500 font-black mb-1 block">ç¶“è¾¦è¯çµ¡é›»è©±</label>
                                {/* ğŸŸ¢ ä¿®æ­£ï¼šç§»é™¤ required */}
                                <input placeholder="é›»è©±" type="tel" className="w-full bg-gray-50 border-none rounded-xl p-4 text-base md:text-lg font-bold font-sans"
                                value={formData.orderPhone} onChange={e => setFormData({...formData, orderPhone: e.target.value})} />
                              </div>
                          </div>
                        </div>
                      </section>

                      {/* 2. è¨‚è³¼å…§å®¹åˆ—è¡¨ */}
                      <section className="animate-fade-in-up" style={{ animationDelay: '0.2s' }}>
                        {/* ğŸŒŸ ä¿®æ”¹ï¼šæ–°å¢æ›´æ–°è³‡æ–™æŒ‰éˆ• */}
                        <SectionHeader 
                            icon={isReservation ? Icons.Archive : Icons.Bag} 
                            title={isReservation ? "ä¿ç•™å“é …æ¸…å–®" : "è¨‚è³¼å…§å®¹æ¸…å–®"} 
                            rightContent={
                                <button type="button" onClick={() => fetchProducts(true)} className="flex items-center gap-1 text-xs font-bold text-blue-600 bg-blue-50 px-3 py-1.5 rounded-full hover:bg-blue-100 transition-colors">
                                    <Icons.Refresh size={12} />
                                    æ›´æ–°ç”¢å“è³‡æ–™
                                </button>
                            }
                        />
                        <div className="space-y-5">
                          {items.map((item, index) => (
                            <div key={item.id} className="bg-white p-6 md:p-8 rounded-[2rem] shadow-sm border border-gray-100 relative group transition-all hover:shadow-md">
                              <div className="absolute top-0 right-0 bg-gray-100 text-[11px] px-4 py-2 rounded-bl-2xl text-gray-400 font-mono font-bold uppercase tracking-tighter">ITEM {index + 1}</div>
                              <div className="space-y-6">
                                <div className="w-full">
                                  <label className="text-xs md:text-sm text-gray-400 font-black uppercase tracking-widest mb-2 block">ç”¢å“å‹è™Ÿ / å“å</label>
                                  {/* ğŸŒŸ ä½¿ç”¨æœå°‹å»ºè­°çµ„ä»¶ */}
                                  <ProductAutocomplete 
                                    value={item.name} 
                                    onChange={(val) => updateItem(item.id, 'name', val)}
                                    onSelect={(product) => handleProductSelect(item.id, product)}
                                    productList={productList}
                                    isLoading={isProductLoading}
                                  />
                                </div>
                                <div className="flex flex-col md:flex-row gap-5">
                                  {/* æ•¸é‡èˆ‡å–®ä½ */}
                                  <div className="flex-[2]">
                                    <label className="text-xs md:text-sm text-gray-400 font-black uppercase tracking-widest mb-2 block">æ•¸é‡ / å–®ä½</label>
                                    <div className="flex gap-2 h-[60px]"> 
                                        <input required className="flex-[2] h-full bg-gray-50 border-none rounded-xl px-5 text-lg md:text-xl font-bold text-center focus:ring-2 focus:ring-[#c25e00]/20 outline-none transition-all font-sans min-w-0"
                                        placeholder="0" value={item.qty} onChange={e => updateItem(item.id, 'qty', e.target.value)} />
                                        
                                        <div className="flex-1 relative h-full min-w-[90px]">
                                            <select 
                                                className="w-full h-full bg-gray-100 border-none rounded-xl pl-4 pr-8 text-lg font-bold text-gray-700 focus:ring-2 focus:ring-[#c25e00]/20 outline-none appearance-none font-sans cursor-pointer hover:bg-gray-200 transition-colors text-center"
                                                value={item.unit || 'å¼µ'}
                                                onChange={e => updateItem(item.id, 'unit', e.target.value)}
                                            >
                                                <option value="å¼µ">å¼µ</option>
                                                <option value="ç‰‡">ç‰‡</option>
                                                <option value="æ‰">æ‰</option>
                                                <option value="æ”¯">æ”¯</option>
                                            </select>
                                            <div className="absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-gray-400">
                                                <Icons.ChevronDown size={16} />
                                            </div>
                                        </div>
                                    </div>
                                  </div>
                                  <div className="flex-[3]">
                                    <label className="text-xs md:text-sm text-gray-400 font-black uppercase tracking-widest mb-2 block">å‚™è¨»èªªæ˜</label>
                                    <input className="w-full h-[60px] bg-gray-50 border-none rounded-xl px-5 text-lg md:text-xl font-medium focus:ring-2 focus:ring-[#c25e00]/20 outline-none transition-all placeholder:text-gray-200 font-sans"
                                      placeholder="æ‰¹è™Ÿæˆ–å€åŸŸ" value={item.note} onChange={e => updateItem(item.id, 'note', e.target.value)} />
                                  </div>
                                </div>
                              </div>
                              {items.length > 1 && (
                                <button type="button" onClick={() => removeItem(item.id)} className="absolute -left-3 -top-3 bg-white text-red-400 shadow-lg rounded-full p-2.5 border border-red-50 hover:bg-red-50 active:scale-90 transition-all">
                                  <Icons.Trash size={18} />
                                </button>
                              )}
                            </div>
                          ))}
                          <button type="button" onClick={addItem} className="w-full py-5 border-2 border-dashed border-gray-200 text-gray-400 rounded-[2rem] font-black text-lg flex items-center justify-center gap-3 hover:border-[#c25e00] hover:text-[#c25e00] hover:bg-white transition-all active:scale-[0.98]">
                            <Icons.Plus size={24} /> æ–°å¢å“é …
                          </button>
                        </div>
                      </section>

                      {/* 3. é…é€/ä¿ç•™è³‡è¨Š */}
                      <section className="animate-fade-in-up" style={{ animationDelay: '0.3s' }}>
                        <SectionHeader icon={Icons.Truck} title={isReservation ? "é è¨ˆéœ€æ±‚è³‡è¨Š" : "å‡ºè²¨èˆ‡ç¾å ´è³‡è¨Š"} />
                        <div className={`bg-white p-8 rounded-[2.5rem] shadow-sm border border-gray-100 space-y-8 ${isReservation ? 'ring-2 ring-blue-50' : ''}`}>
                          
                          {/* æ—¥æœŸæ¬„ä½å€å¡Š */}
                          <div className="grid grid-cols-1 md:grid-cols-2 gap-6">

                            <div className="space-y-2">
                              {/* ğŸŸ¢ ä¿®æ­£ï¼šé€è²¨æ—¥æœŸ -> å‡ºè²¨æ—¥æœŸ */}
                              <label className="text-xs md:text-sm text-gray-400 font-black uppercase mb-1 block">
                                  {isReservation ? "é è¨ˆå‡ºè²¨æ—¥æœŸ" : "å‡ºè²¨æ—¥æœŸ"}
                              </label>
                              <input required type="date" className="w-full bg-gray-50 border-none rounded-xl p-4 text-base md:text-lg font-bold focus:ring-2 focus:ring-[#c25e00]/20 font-sans"
                                value={formData.deliveryDate} onChange={e => setFormData({...formData, deliveryDate: e.target.value})} />
                            </div>

                            <div className="space-y-2">
                              <label className="text-xs md:text-sm text-gray-400 font-black uppercase mb-1 block">åå¥½æ™‚æ®µ</label>
                              <select className="w-full bg-gray-50 border-none rounded-xl p-4 text-base md:text-lg font-bold focus:ring-2 focus:ring-[#c25e00]/20 appearance-none cursor-pointer font-sans"
                                value={formData.deliveryTime} onChange={e => setFormData({...formData, deliveryTime: e.target.value})}>
                                <option>ä¸Šåˆ (09-12)</option>
                                <option>ä¸‹åˆ (13-17)</option>
                                <option>ä¸é™æ™‚é–“</option>
                              </select>
                            </div>
                          </div>

                          <div className="space-y-2">
                            <label className="text-xs md:text-sm text-gray-400 font-black uppercase mb-1 block">
                                  {isReservation ? "é è¨ˆé€è²¨åœ°å€ / æ¡ˆä»¶åç¨± (å¯å¾Œè£œ)" : "å‡ºè²¨åœ°å€"}
                            </label>
                            <input 
                                required={!isReservation}
                                placeholder={isReservation ? "å¦‚æœªç¢ºå®šå¯ç•™ç©ºï¼Œæˆ–å¡«å¯«æ¡ˆä»¶åç¨±" : "è«‹å¡«å¯«å®Œæ•´å‡ºè²¨åœ°å€"} 
                                className="w-full bg-gray-50 border-none rounded-xl p-5 text-lg md:text-xl font-bold focus:ring-2 focus:ring-[#c25e00]/20 font-sans"
                                value={formData.deliveryAddress} onChange={e => setFormData({...formData, deliveryAddress: e.target.value})} 
                            />
                          </div>
                          <div className="grid grid-cols-1 md:grid-cols-2 gap-6 pt-6 border-t border-gray-50">
                            <div className="space-y-2">
                              <label className="text-xs md:text-sm text-gray-500 font-black mb-1 block">
                                  {isReservation ? "ç¾å ´æ”¶è²¨äººå§“å (å¯å¾Œè£œ)" : "ç¾å ´æ”¶è²¨äººå§“å"}
                              </label>
                              <input 
                                required={!isReservation}
                                placeholder={isReservation ? "å¦‚æœªç¢ºå®šå¯ç•™ç©º" : "å§“å"} 
                                className="w-full bg-gray-50 border-none rounded-xl p-4 text-base md:text-lg font-bold font-sans"
                                value={formData.deliveryContact} onChange={e => setFormData({...formData, deliveryContact: e.target.value})} 
                              />
                            </div>
                            <div className="space-y-2">
                              <label className="text-xs md:text-sm text-gray-500 font-black mb-1 block">
                                  {isReservation ? "ç¾å ´è¯çµ¡é›»è©± (å¯å¾Œè£œ)" : "ç¾å ´è¯çµ¡é›»è©±"}
                              </label>
                              <input 
                                required={!isReservation}
                                placeholder={isReservation ? "å¦‚æœªç¢ºå®šå¯ç•™ç©º" : "é›»è©±"} 
                                type="tel" 
                                className="w-full bg-gray-50 border-none rounded-xl p-4 text-base md:text-lg font-bold font-sans"
                                value={formData.deliveryPhone} onChange={e => setFormData({...formData, deliveryPhone: e.target.value})} 
                              />
                            </div>
                          </div>
                        </div>
                      </section>
                      
                       {/* ğŸŒŸ æ–°å¢ï¼šè¨˜ä½æˆ‘ Checkbox */}
                       <div className="flex items-center justify-center mb-6">
                            <label className="checkbox-wrapper flex items-center cursor-pointer group">
                                <input 
                                    type="checkbox" 
                                    className="hidden" 
                                    checked={rememberMe} 
                                    onChange={(e) => setRememberMe(e.target.checked)}
                                />
                                <div className="w-6 h-6 border-2 border-gray-300 rounded-lg mr-3 flex items-center justify-center transition-all group-hover:border-[#c25e00]">
                                    <svg className="w-3.5 h-3.5 text-white hidden pointer-events-none" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="3" d="M5 13l4 4L19 7"></path></svg>
                                </div>
                                <span className={`text-sm font-bold transition-colors ${rememberMe ? 'text-[#c25e00]' : 'text-gray-400 group-hover:text-gray-600'}`}>
                                    è¨˜ä½è¨‚è³¼è³‡æ–™ (å…¬å¸ã€å§“åã€é›»è©±)ï¼Œä¸‹æ¬¡è‡ªå‹•å¸¶å…¥
                                </span>
                            </label>
                       </div>

                      {/* --- é å°¾è³‡è¨Šå€ --- */}
                      <div className="mt-8 mb-24 md:hidden space-y-5 text-center border-t border-gray-200 pt-10 px-4">
                        <div className="space-y-4">
                          <div className="w-10 h-1 bg-[#c25e00] mx-auto mb-4 rounded-full"></div>
                          <h4 className="font-black text-gray-900 tracking-[0.1em] text-lg whitespace-nowrap">è–©é‰…åœ‹éš›æœ‰é™å…¬å¸</h4>
                          <div className="text-[11px] text-gray-400 space-y-3 flex flex-col items-center font-medium">
                            <div className="flex items-center gap-2 hover:text-gray-600 transition-colors whitespace-nowrap">
                              <Icons.Pin size={12} className="text-[#c25e00]" /> æ–°åŒ—å¸‚æ¿æ©‹å€é‡‘é–€è¡—215å··78-5è™Ÿ
                            </div>
                            <div className="flex gap-6 justify-center">
                              <a href="tel:0286860028" className="flex items-center gap-2 hover:text-[#c25e00] transition-colors font-bold text-gray-500">
                                <Icons.Phone size={12} /> 02-86860028
                              </a>
                              <span className="flex items-center gap-2 text-gray-300">
                                ğŸ“  02-81926543
                              </span>
                            </div>
                            {/* ğŸŸ¢ æ–°å¢ï¼šæ‰‹æ©Ÿç‰ˆåº•éƒ¨ LINE é€£çµ */}
                            <a href="https://line.me/R/ti/p/@tileparktw" target="_blank" rel="noreferrer" className="flex items-center gap-2 hover:text-[#06C755] transition-colors font-bold text-gray-500">
                                <Icons.Line size={12} /> LINE: @tileparktw
                            </a>
                          </div>
                        </div>
                        <div className="text-[10px] text-gray-300 font-serif tracking-[1em] uppercase py-4">
                          TILE PARK TAIWAN
                        </div>
                      </div>
                    </div>

                    {/* --- åº•éƒ¨æäº¤æŒ‰éˆ• --- */}
                    <div className="fixed bottom-0 left-0 right-0 p-5 bg-white/80 backdrop-blur-xl border-t border-gray-100 md:static md:bg-transparent md:border-none md:p-0 md:mt-16 z-50">
                      <button 
                        type="submit" 
                        disabled={loading} 
                        className={`w-full text-white py-6 rounded-3xl font-black tracking-[0.4em] text-xl hover:shadow-2xl hover:-translate-y-1 transition-all disabled:bg-gray-300 shadow-xl flex items-center justify-center gap-4 active:scale-95 group font-sans
                            ${isReservation ? 'bg-blue-600 hover:bg-blue-500' : 'bg-[#222] hover:bg-[#c25e00]'}
                        `}
                      >
                        {loading ? (
                          <div className="w-6 h-6 border-4 border-white/30 border-t-white rounded-full animate-spin"></div>
                        ) : (
                          <>
                              {isReservation ? 'é€å‡ºä¿ç•™å–®' : 'é€å‡ºè¨‚å–®'} 
                              <Icons.Next size={24} className="group-hover:translate-x-2 transition-transform" />
                          </>
                        )}
                      </button>
                    </div>
                  </form>
                </main>
              </div>
            </div>
          );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>